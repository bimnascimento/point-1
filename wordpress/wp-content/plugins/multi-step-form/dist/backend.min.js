!function(e){"use strict";function t(){"console"in window&&console.log.apply(console,arguments)}function a(){"console"in window&&console.warn.apply(console,arguments)}function i(){return{title:"",headline:"",copy_text:"",parts:[{title:"",blocks:[]}]}}function l(t,a){var i;i=a?"#4caf50":"#f44336",e('<div id="fw-alert" style="background-color:'+i+'">'+t+"</div>").hide().appendTo("#wpbody-content").slideDown().delay(3e3).slideUp()}function n(e){var t='<div class="fw-block-action fw-block-hndle">';return t+='<i class="fa fa-arrows fw-move-block fw-block-hndle" aria-hidden="true"></i>',t+="<h4>"+e+"</h4>",t+="</div>"}function r(e){var t='<div class="fw-radio-option-element" data-type="header"><label>'+wizard.i18n.label+"</label>";return t+='<input type="text" class="fw-radio-header fw-block-label" value="'+e+'"></input>',t+="</div>"}function o(e,t){var a='<div class="fw-radio-option-element" data-type="option">';return a+='<input type="text" class="fw-radio-option" placeholder="'+wizard.i18n.radio.option+" "+t+'" value="'+e+'"></input>',a+='<div class="fw-remove-radio-option"><i class="fa fa-minus-circle" aria-hidden="true"></i></div></div>'}function c(e){t("radio",e);var a,i,l,n=0,c="";for(c+='<div class="fw-radio-option-container">',a=0,i=e.elements.length;a<i;a++)l=e.elements[a],t("element",l),"option"===l.type?(1==a&&(c+="<label>"+wizard.i18n.radio.options+"</label>"),c+=o(l.value,1+n++)):c+=r(l.value);return c+="</div>",c+='<button class="fw-radio-add"><i class="fa fa-plus" aria-hidden="true"></i> '+wizard.i18n.radio.addOption+"</button><br/>",c+='<label><input type="checkbox" class="fw-required"'+R(e.required)+"/> "+wizard.i18n.required+"</label>",c+="true"==e.multichoice?'<label><input type="checkbox" class="fw-radio-multichoice" checked/>'+wizard.i18n.radio.multiple+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.multiChoice+'"></i></label>':'<label><input type="checkbox" class="fw-radio-multichoice"/>'+wizard.i18n.radio.multiple+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.multiChoice+'"></i></label>'}function s(e){t("select",e);var a=0,i="";for(i+='<div class="fw-select-option-container">',i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-block-label" value="'+e.label+'"></input>',i+="<label>"+wizard.i18n.select.options+"</label>",i+='<textarea class="fw-select-options" rows="4" cols="50">',a=0;a<e.elements.length;a++)i+=e.elements[a]+"\n";return i+="</textarea>",i+="</div>",i+='<label><input type="checkbox" class="fw-select-search"'+R(e.search)+"/>"+wizard.i18n.select.search+"</label>",i+='<label><input type="checkbox" class="fw-required"'+R(e.required)+"/> "+wizard.i18n.required+"</label>"}function d(e){t("checkbox",e);var a="";return a+="<label>"+wizard.i18n.label+"</label>",a+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',a+='<label><input type="checkbox" class="fw-required"'+R(e.required)+"/>"+wizard.i18n.required+"</label>"}function f(e){t("textInput",e);var a="";return a+="<label>"+wizard.i18n.label+"</label>",a+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',a+='<label><input type="checkbox" class="fw-required"'+R(e.required)+"/>"+wizard.i18n.required+"</label>"}function p(e){var t="";return t+="<label>"+wizard.i18n.label+"</label>",t+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',t+='<label><input type="checkbox" class="fw-required"'+R(e.required)+"/>"+wizard.i18n.required+"</label>"}function u(e){var t="";return t+="<label>"+wizard.i18n.label+"</label>",t+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',t+='<label><input type="checkbox" class="fw-required"'+R(e.required)+"/>"+wizard.i18n.required+"</label>"}function w(e){var t="";return t+="<label>"+wizard.i18n.label+"</label>",t+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',t+='<label><input type="checkbox" class="fw-required"'+R(e.required)+"/>"+wizard.i18n.required+"</label>"}function b(e){t("textArea",e);var a="";return a+="<label>"+wizard.i18n.label+"</label>",a+='<input type="text" class="fw-textarea-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',a+='<label><input type="checkbox" class="fw-required"'+R(e.required)+"/>"+wizard.i18n.required+"</label>"}function v(e){var t="";return t+="<label>"+wizard.i18n.paragraph.textHtml+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.paragraph+'"></i></label>',t+='<textarea class="fw-paragraph-text fw-block-label" placeholder="'+wizard.i18n.paragraph.text+'">'+(e.text?e.text:"")+"</textarea>"}function h(e){t("block",e);var a=!1,i='<div class="fw-step-block" data-type="'+e.type+'" >';switch(i+='<div class="fw-block-controls">',i+='<i class="fa fa-remove fw-remove-block" title="'+wizard.i18n.tooltips.removeBlock+'" aria-hidden="true"></i>',i+='<i class="fa fa-caret-up fw-toggle-block" aria-hidden="true"></i>',i+="</div>",i+=n(e.type),i+='<div class="fw-block-fields">',e.type){case"radio":e.elements||(e.elements=[{type:"header",value:""},{type:"option",value:""}]),i+=c(e);break;case"select":e.elements||(e.elements=[]),i+=s(e);break;case"checkbox":i+=d(e);break;case"text":i+=f(e);break;case"email":i+=p(e);break;case"file":i+=u(e);break;case"date":i+=w(e);break;case"textarea":i+=b(e);break;case"paragraph":i+=v(e)}return i+="</div>",i+='<div class="fw-clearfix"></div>',i+="</div>",a&&(i=""),i}function k(e){var t,a,i="";for(t=0,a=e.length;t<a;t++)i+=h(e[t]);return i}function m(e,a){t("part",e);var i='<div class="'+a+'">';return i+='<div class="fw-section-hndle"><i class="fa fa-arrows"></i></div>',i+='<input type="text" class="fw-part-title" value="'+e.title+'" placeholder="'+wizard.i18n.partTitle+'"></input>',i+='<div class="fw-remove-part" title="'+wizard.i18n.removeSection+'">',i+='<i class="fa fa-remove"></i>',i+='</div><div class="inside connectedSortable">',i+=k(e.blocks),i+='</div><div class="fw-add-element">',i+='<a href="#TB_inline?width=400&height=200&inlineId=fw-thickbox-content" class="thickbox"><i class="fa fa-plus"></i> '+wizard.i18n.addElement+"</a>",i+="</div>",i+="</div>"}function g(e,t){var a="fw-step-part";return a}function x(e){var t,a=e.length,i='<div><div class="fw-parts-header"><h3>Sections</h3></div>';for(i+='<div class="fw-column-buttons">',i+='<button type="button" class="fw-button-one-column"><i class="fa fa-align-justify"></i></button>',i+='<button type="button" class="fw-button-two-columns"><i class="fa fa-align-justify"></i> <i class="fa fa-align-justify"></i></button>',i+="</div>",i+='<div class="fw-parts-container">',t=0,a=e.length;t<a;t++){var l=g(t,a);i+=m(e[t],l)}return i+="</div>",i+='<div class="fw-parts-footer">',i+='<a class="fw-add-part"><i class="fa fa-plus"></i> '+wizard.i18n.addSection+"</a>",i+="</div>",i+="</div>"}function y(e,t){var a="fw-title-"+t,i="fw-headline-"+t,l="fw-copy-text-"+t,n='<div class="fw-step"><div class="form-wrap">';return n+='<div class="input form-field">',n+='<label for="'+a+'"><b>'+wizard.i18n.title+"</b>",n+='<i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.title+'"></i></label>',n+='<input type="text" class="fw-step-title" value="'+e.title+'"></input>',n+="</div>",n+='<div class="input form-field">',n+='<label for="'+i+'"><b>'+wizard.i18n.headline+"</b>",n+='<i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.headline+'"></i></label>',n+='<input type="text" class="fw-step-headline" value="'+e.headline+'"></input>',n+="</div>",n+='<div class="input form-field">',n+='<label for="'+l+'"><b>'+wizard.i18n.copyText+"</b>",n+='<i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.copyText+'"></i></label>',n+='<input type="text" class="fw-step-copy_text" value="'+e.copy_text+'"></input>',n+="</div>",n+='<div class="fw-step-parts">'+x(e.parts)+"</div>",n+='</div><div class="fw-clearfix"></div></div>'}function z(e){var t='<div class="postbox">';return t+='<div class="fw-movediv hndle ui-sortable-handle"><i class="fa fa-arrows"></i></div>',t+='<h1 class="fw-step-h1 hndle ui-sortable-handle"><span>',t+=e.title+"</span></h1>",t+='<div class="fw-step-controls">',t+='<i class="fa fa-remove fw-remove-step" title="'+wizard.i18n.tooltips.removeStep+'" aria-hidden="true"></i>',t+='<i class="fa fa-caret-up fw-toggle-step" aria-hidden="true"></i>',t+='<i class="fa fa-files-o fw-duplicate-step" title="duplicate step" aria-hidden="true"></i>',t+="</div>",t+='<div class="fw-clearfix"></div>',t+=y(e),t+='<div class="fw-clearfix"></div>',t+="</div>"}function q(t){t&&(t.thankyou&&e(".fw-settings-thankyou").val(t.thankyou),t.subject&&e(".fw-mail-subject").val(t.subject),t.to&&e(".fw-mail-to").val(t.to),t.frommail&&e(".fw-mail-from-mail").val(t.frommail),t.fromname&&e(".fw-mail-from-name").val(t.fromname),t.header&&e(".fw-mail-header").val(t.header))}function C(t){var a,i,l='<div class="postbox-container"><div class="metabox-holder"><div class="meta-box-sortables">';for(a=0,i=t.length;a<i;a++)l+=z(t[a],a);l+="</div>",l+='<a class="fw-element-step"><i class="fa fa-plus"></i> '+wizard.i18n.addStep+"</a>",l+="</div></div>",e(ne).html(l)}function j(e){var t={},a=t.type=e.attr("data-type");return"option"===a?t.value=e.find(".fw-radio-option").val():"header"===a&&(t.value=e.find(".fw-radio-header").val()),t}function _(t,a){var i=a.elements=[];t.find(".fw-radio-option-element").each(function(t,a){i.push(j(e(a)))}),a.required=t.find(".fw-required").prop("checked"),a.multichoice=t.find(".fw-radio-multichoice").prop("checked")}function S(e,t){var a=e.find(".fw-select-options").val().split("\n");t.required=e.find(".fw-required").prop("checked"),t.search=e.find(".fw-select-search").prop("checked"),t.label=e.find(".fw-block-label").val(),t.elements=a.filter(function(e){return""!==e&&" "!==e})}function T(e,t){t.label=e.find(".fw-text-label").val(),t.required=e.find(".fw-required").prop("checked")}function O(e,t){t.label=e.find(".fw-text-label").val(),t.required=e.find(".fw-required").prop("checked")}function A(e,t){t.label=e.find(".fw-text-label").val(),t.required=e.find(".fw-required").prop("checked")}function U(e,t){t.label=e.find(".fw-text-label").val(),t.required=e.find(".fw-required").prop("checked")}function D(e,t){t.label=e.find(".fw-text-label").val(),t.required=e.find(".fw-required").prop("checked")}function B(e,t){t.label=e.find(".fw-textarea-label").val(),t.required=e.find(".fw-required").prop("checked")}function E(e,t){t.text=e.find(".fw-paragraph-text").val()}function F(e){var t={},a=t.type=e.attr("data-type");switch(a){case"radio":_(e,t);break;case"select":S(e,t);break;case"checkbox":T(e,t);break;case"text":O(e,t);break;case"email":A(e,t);break;case"file":U(e,t);break;case"date":D(e,t);break;case"textarea":B(e,t);break;case"paragraph":E(e,t)}return t}function W(t){var a={};a.title=t.find(".fw-part-title").val();var i=a.blocks=[];return t.find(".fw-step-block").each(function(t,a){i.push(F(e(a)))}),a}function Z(t){var a={};a.title=t.find(".fw-step-title").val(),a.headline=t.find(".fw-step-headline").val(),a.copy_text=t.find(".fw-step-copy_text").val();var i=a.parts=[],l=t.find(".fw-step-part");return l.each(function(t,a){i.push(W(e(a)))}),a}function I(){var t={};return t.thankyou=e(".fw-settings-thankyou").val(),t.to=e(".fw-mail-to").val(),t.frommail=e(".fw-mail-from-mail").val(),t.fromname=e(".fw-mail-from-name").val(),t.subject=e(".fw-mail-subject").val(),t.header=e(".fw-mail-header").val(),t}function M(e){var t=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return!!e&&t.test(e)}function P(t){var a=!0;return M(t.to)?t.subject||(a=!1,e("#fw-nav-settings").trigger("click"),l(wizard.i18n.alerts.noSubject,!1)):(a=!1,e("#fw-nav-settings").trigger("click"),l(wizard.i18n.alerts.invalidEmail,!1)),a}function H(e){for(var t=!0,a=0;a<e.length;a++){var i=e[a];if(i.title)for(var n=0;n<e[a].parts.length;n++)""===e[a].parts[n].title&&(t=!1,l(wizard.i18n.alerts.noSectionTitle,!1));else t=!1,l(wizard.i18n.alerts.noStepTitle,!1)}return t}function J(e){var t=!0;return""===e.title?(t=!1,l(wizard.i18n.alerts.noFormTitle,!1)):t=H(e.wizard.steps)&&P(e.wizard.settings),t}function N(){var a=e(ne),i=e(".fw-wizard-title").val(),n={wizard:{}};n.wizard.title=i,n.wizard.steps=[],n.wizard.settings=I();var r=a.find(".fw-step");r.each(function(t,a){t==r.length-1;n.wizard.steps.push(Z(e(a)))}),n.wizard.steps.push(),J(n)&&(t("save",n),t("ajaxurl",wizard.ajaxurl),t("nonce",wizard.nonce),e.ajax({type:"POST",url:wizard.ajaxurl,dataType:"json",data:{action:"fw_wizard_save",data:n,nonce:wizard.nonce,id:wizard.id},success:function(e){t("response",e),l(e.data.msg,e.success)},error:function(e){t("fail",arguments),t("response",e)}}))}function Q(){e(".meta-box-sortables").sortable({opacity:.6,revert:!0,cursor:"move",handle:".hndle",tolerance:"pointer",placeholder:"fw-block-placeholder",start:function(t,a){var i=e(a.item).height();e(".fw-block-placeholder").height(i)},update:function(t,i){a("sortables update",t,i),e(i.item).removeAttr("style"),Q(),Y()}}),e(".fw-step-part .inside").sortable({opacity:.6,cursor:"move",connectWith:".connectedSortable",handle:".fw-block-hndle",tolerance:"intersect",placeholder:"fw-block-placeholder",revert:100,start:function(t,a){var i=e(a.item).height(),l=e(".fw-block-placholder");l.height(i),l.attr("data-type",a.item.attr("data-type"))},update:function(t,i){a("block sortables update",t,i);var l=e(i.item).attr("data-type");e(i.item).is(".fw-draggable-block")&&e(i.item).replaceWith(e(h({type:l,label:""}))),Q(),Y(),ie()}}),e(".fw-parts-container").sortable({opacity:.6,cursor:"move",connectWith:".fw-parts-container",handle:".fw-section-hndle",tolerance:"intersect",placeholder:"fw-section-placeholder",revert:100,start:function(t,a){var i=e(a.item).height();e(".fw-section-placeholder").height(i)},update:function(e,t){Q(),Y(),ie()}});e(re+" .fw-draggable-block").draggable({connectToSortable:".fw-step-part .inside",revert:"invalid",helper:"clone",cursor:"move"}),e(ne).find(".fw-step-title").on("change input",$)}function Y(){e(".fa-info-circle").tooltip(),e(".fw-remove-step").tooltip(),e(".fw-duplicate-step").tooltip(),e(".fw-remove-part").tooltip(),e(".fw-remove-block").tooltip(),e(".hndle.ui-sortable-handle").tooltip()}function $(a){var i=e(this);t("titleOnChangeU",i.val()),i.closest(".postbox").find("h1 > span").html(i.val())}function G(a){a.find('.fw-radio-option-element[data-type="option"] > label').each(function(a,i){t("updateOptions",i),e(i).html("Option "+(a+1))})}function K(t){var a=e(".fw-step").length;if(a<5){var i=e(z(t));i.appendTo(e(ne).find(".meta-box-sortables")),ie(),Q(),ae(),a>0&&e("html, body").animate({scrollTop:e(document).height()-i.height()-180},500)}else l(wizard.i18n.alerts.onlyFive,!1)}function L(e){var t=Z(e);t.title+=" (COPY)",K(t)}function R(e){var t="";return"true"==e&&(t="checked"),t}function V(t){var a=t.target,i=m({title:"",blocks:[]},"fw-step-part");e(a).closest(".fw-step-parts").find(".fw-parts-container").append(i),e(".fw-remove-part").click(function(e){ee(e)}),ae()}function X(){var t=e(this),a=t.closest(".postbox"),i=confirm(wizard.i18n.alerts.reallyDeleteStep);i===!0&&a.slideUp(700,function(){a.remove()})}function ee(t){var a=e(t.target).closest(".fw-step-part"),i=confirm(wizard.i18n.alerts.reallyDeleteSection);i===!0&&a.slideUp(500,function(){a.remove()})}function te(t){var a=e(t.target).closest(".fw-step-block"),i=a.find(".fw-block-label").val(),l=confirm(wizard.i18n.alerts.reallyDeleteBlock+"\n\n"+i);l===!0&&a.slideUp(300,function(){a.remove()})}function ae(){e(".thickbox").click(function(t){e("#fw-thickbox-radio").unbind("click").click(function(a){tb_remove();var i=e(h({type:"radio"})),l=e(t.target).parents(".fw-step-part");l.find(".inside").append(i),ie()}),e("#fw-thickbox-select").unbind("click").click(function(a){tb_remove();var i=e(h({type:"select",label:""})),l=e(t.target).parents(".fw-step-part");l.find(".inside").append(i),ie()}),e("#fw-thickbox-text").unbind("click").click(function(a){tb_remove();var i=e(h({type:"text",label:"",value:""})),l=e(t.target).parents(".fw-step-part");l.find(".inside").append(i),ie()}),e("#fw-thickbox-email").unbind("click").click(function(a){tb_remove();var i=e(h({type:"email",label:"",value:""})),l=e(t.target).parents(".fw-step-part");l.find(".inside").append(i),ie()}),e("#fw-thickbox-fileupload").unbind("click").click(function(a){tb_remove();var i=e(h({type:"file",label:"",value:""})),l=e(t.target).parents(".fw-step-part");l.find(".inside").append(i),ie()}),e("#fw-thickbox-textarea").unbind("click").click(function(a){tb_remove();var i=e(h({type:"textarea",label:"",value:""})),l=e(t.target).parents(".fw-step-part");l.find(".inside").append(i),ie()}),e("#fw-thickbox-date").unbind("click").click(function(a){tb_remove();var i=e(h({type:"date",label:""})),l=e(t.target).parents(".fw-step-part");l.find(".inside").append(i),ie()}),e("#fw-thickbox-paragraph").unbind("click").click(function(a){tb_remove();var i=e(h({type:"paragraph",text:""})),l=e(t.target).parents(".fw-step-part");l.find(".inside").append(i),ie()})})}function ie(){e(".fw-element-step").unbind("click").click(function(e){K(i())}),e(".fw-duplicate-step").unbind("click").click(function(t){var a=e(this).parent().parent().find(".fw-step");L(a)}),e(".fw-add-part").unbind("click").click(function(e){V(e),Q()}),e(".fw-toggle-step").unbind("click").click(function(t){e(this).parent().parent().find(".fw-step").slideToggle(),e(this).toggleClass("fw-icon-rotated")}),e(".fw-remove-part").unbind("click").click(function(e){ee(e)}),e(".fw-remove-block").unbind("click").click(function(e){te(e)}),e(".fw-toggle-block").unbind("click").click(function(t){var a=e(this).parent().parent();if(a.toggleClass("fw-block-collapsed"),a.hasClass("fw-block-collapsed")){var i=a.find(".fw-block-label").val();a.find("h4").text(i),e(this).addClass("fw-icon-rotated")}else{var l=a.data("type");a.find("h4").text(l),e(this).removeClass("fw-icon-rotated")}})}function le(){try{var l=JSON.parse(wizard.json),n=e(ne);l.wizard.title?e(".fw-wizard-title").val(l.wizard.title):e(".fw-wizard-title").val("My Multi Step Form");var r=l.wizard.steps&&l.wizard.steps.length>0?l.wizard.steps:[i()];C(r),q(l.wizard.settings),e(".fw-button-save").click(N),e(window).scroll(function(){var t=e(".nav-tab-wrapper").height()+19,a=e(this).scrollTop();a>t?e(re).addClass("fw-sticky"):e(re).removeClass("fw-sticky")}),n.on("click",".postbox .handlediv",function(){e(this).closest(".postbox").toggleClass("closed")}),n.on("click",".fw-radio-add",function(){var t=e(this).prev(".fw-radio-option-container"),a=t.children(".fw-radio-option-element").length,i=o("",a);e(i).appendTo(t),G(t)}),n.on("click",".fw-remove-radio-option",function(){t("remove on click");var a=e(this),i=a.closest(".fw-radio-option-container");a.closest(".fw-radio-option-element").remove(),G(i)}),n.on("click",".fw-remove-step",X),Q(),Y(),ae(),ie(),e("#fw-nav-settings").click(function(t){e("#fw-nav-steps").toggleClass("nav-tab-active"),e("#fw-nav-settings").toggleClass("nav-tab-active"),e(ne).hide(),e(re).hide(),e(".fw-mail-settings-container").show()}),e("#fw-nav-steps").click(function(t){e("#fw-nav-steps").toggleClass("nav-tab-active"),e("#fw-nav-settings").toggleClass("nav-tab-active"),e(".fw-mail-settings-container").hide(),e(ne).show(),e(re).show()}),e("#fw-elements-modal").dialog({dialogClass:"wp-dialog",modal:!0,autoOpen:!1,closeOnEscape:!0,buttons:{Close:function(){e(this).dialog("close")}}})}catch(e){a(e)}}var ne="#fw-wizard-container",re="#fw-elements-container";e(document).ready(le)}(jQuery);